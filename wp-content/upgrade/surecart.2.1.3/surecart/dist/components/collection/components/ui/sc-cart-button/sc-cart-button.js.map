{"version":3,"file":"sc-cart-button.js","sourceRoot":"","sources":["../../../../src/components/ui/sc-cart-button/sc-cart-button.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,eAAe,CAAC;AACnE,OAAO,OAAO,MAAM,WAAW,CAAC;AAChC,OAAO,KAAK,EAAE,EAAE,WAAW,EAAE,MAAM,kBAAkB,CAAC;AAEtD;;;GAGG;AAMH,MAAM,OAAO,YAAY;;gBAME,IAAI;iBAGJ,CAAC;;gBAMM,MAAM;+BAGC,IAAI;0BAGT,KAAK;;EAEvC,KAAK;IACH,OAAO,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;EAC7C,CAAC;EAED,6CAA6C;EAC7C,aAAa;;IACX,MAAM,KAAK,GAAG,MAAA,MAAA,IAAI,CAAC,KAAK,EAAE,0CAAE,UAAU,0CAAE,IAAI,CAAC;IAC7C,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;MAC3B,KAAK,GAAG,KAAK,IAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,QAAQ,CAAA,CAAC;IACjC,CAAC,CAAC,CAAC;IACH,OAAO,KAAK,CAAC;EACf,CAAC;EAED,gBAAgB;IACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACjC,0EAA0E;IAC1E,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAC,EAAE;MACtC,CAAC,CAAC,cAAc,EAAE,CAAC;MACnB,CAAC,CAAC,wBAAwB,EAAE,CAAC;MAC7B,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;MAC/E,OAAO,KAAK,CAAC;IACf,CAAC,CAAC,CAAC;IAEH,+DAA+D;IAC/D,IAAI,CAAC,uBAAuB,EAAE,CAAC;IAC/B,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,CAAC;EAClE,CAAC;EAED,uBAAuB;IACrB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,mBAAmB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;EAC/F,CAAC;EAED,MAAM;IACJ,OAAO,CACL,WAAK,KAAK,EAAC,cAAc,EAAC,IAAI,EAAC,MAAM;MACnC,WAAK,KAAK,EAAC,eAAe;QACvB,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAClD,YAAM,KAAK,EAAC,aAAa,EAAC,IAAI,EAAC,OAAO,IACnC,IAAI,CAAC,aAAa,EAAE,CAChB,CACR;QACD,WAAK,KAAK,EAAC,YAAY;UACrB,eAAQ,CACJ,CACF,CACF,CACP,CAAC;EACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import { Component, Element, h, Prop, State } from '@stencil/core';\nimport uiStore from '@store/ui';\nimport store, { getCheckout } from '@store/checkouts';\n\n/**\n * @part base - The elements base wrapper.\n * @part count - The icon base wrapper.\n */\n@Component({\n  tag: 'sc-cart-button',\n  styleUrl: 'sc-cart-button.scss',\n  shadow: true,\n})\nexport class ScCartButton {\n  private link: HTMLAnchorElement;\n  /** The cart element. */\n  @Element() el: HTMLScCartButtonElement;\n\n  /** Is this open or closed? */\n  @State() open: boolean = null;\n\n  /** The order count */\n  @State() count: number = 0;\n\n  /** The form id to use for the cart. */\n  @Prop({ reflect: true }) formId: string;\n\n  /** Are we in test or live mode. */\n  @Prop() mode: 'test' | 'live' = 'live';\n\n  /** Whether the cart icon is always shown when the cart is empty */\n  @Prop() cartMenuAlwaysShown: boolean = true;\n\n  /** Whether the cart count will be shown or not when the cart is empty */\n  @Prop() showEmptyCount: boolean = false;\n\n  order() {\n    return getCheckout(this.formId, this.mode);\n  }\n\n  /** Count the number of items in the cart. */\n  getItemsCount() {\n    const items = this.order()?.line_items?.data;\n    let count = 0;\n    (items || []).forEach(item => {\n      count = count + item?.quantity;\n    });\n    return count;\n  }\n\n  componentDidLoad() {\n    this.link = this.el.closest('a');\n    // this is to keep the structure that WordPress expects for theme styling.\n    this.link.addEventListener('click', e => {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n      uiStore.state.cart = { ...uiStore.state.cart, open: !uiStore.state.cart.open };\n      return false;\n    });\n\n    // maybe hide the parent <a> if there are no items in the cart.\n    this.handleParentLinkDisplay();\n    store.onChange(this.mode, () => this.handleParentLinkDisplay());\n  }\n\n  handleParentLinkDisplay() {\n    this.link.style.display = !this.cartMenuAlwaysShown && !this.getItemsCount() ? 'none' : null;\n  }\n\n  render() {\n    return (\n      <div class=\"cart__button\" part=\"base\">\n        <div class=\"cart__content\">\n          {(this.showEmptyCount || !!this.getItemsCount()) && (\n            <span class=\"cart__count\" part=\"count\">\n              {this.getItemsCount()}\n            </span>\n          )}\n          <div class=\"cart__icon\">\n            <slot />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]}