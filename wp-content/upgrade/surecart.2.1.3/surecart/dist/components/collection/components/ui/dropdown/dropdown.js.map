{"version":3,"file":"dropdown.js","sourceRoot":"","sources":["../../../../src/components/ui/dropdown/dropdown.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Prop, Event, EventEmitter, Watch, State, h } from '@stencil/core';\nimport { autoUpdate, computePosition, flip, offset, shift, size } from '@floating-ui/dom';\nimport { ScMenu } from '../menu/sc-menu';\n\n/**\n * @part base - The elements base wrapper.\n * @part trigger - The trigger.\n * @part panel - The panel.\n */\n@Component({\n  tag: 'sc-dropdown',\n  styleUrl: 'dropdown.scss',\n  shadow: true,\n})\nexport class ScDropdown {\n  @Element() el: HTMLDivElement;\n  private panel?: HTMLElement;\n  private trigger?: HTMLElement;\n  private positioner?: HTMLDivElement;\n\n  private positionerCleanup: ReturnType<typeof autoUpdate> | undefined;\n\n  @Prop() clickEl?: HTMLElement;\n\n  /** Is this disabled. */\n  @Prop() disabled: boolean;\n\n  /** Indicates whether or not the dropdown is open. You can use this in lieu of the show/hide methods. */\n  @Prop({ reflect: true, mutable: true }) open?: boolean = false;\n\n  /** The placement of the dropdown panel */\n  @Prop() position: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\n\n  /** The placement of the dropdown. */\n  @Prop({ reflect: true }) placement:\n    | 'top'\n    | 'top-start'\n    | 'top-end'\n    | 'bottom'\n    | 'bottom-start'\n    | 'bottom-end'\n    | 'right'\n    | 'right-start'\n    | 'right-end'\n    | 'left'\n    | 'left-start'\n    | 'left-end' = 'bottom-start';\n\n  /** The distance in pixels from which to offset the panel away from its trigger. */\n  @Prop() distance: number = 10;\n\n  /** The distance in pixels from which to offset the panel along its trigger. */\n  @Prop() skidding: number = 0;\n\n  /**\n   * Enable this option to prevent the panel from being clipped when the component is placed inside a container with\n   * `overflow: auto|scroll`.\n   */\n  @Prop() hoist: boolean = false;\n\n  /** Determines whether the dropdown should hide when a menu item is selected */\n  @Prop({ attribute: 'close-on-select', reflect: true }) closeOnSelect: boolean = true;\n\n  /** Emitted when the dropdown opens. Calling `event.preventDefault()` will prevent it from being opened. */\n  @Event() scShow: EventEmitter<void>;\n\n  /** Emitted when the dropdown closes. Calling `event.preventDefault()` will prevent it from being closed. */\n  @Event() scHide: EventEmitter<void>;\n\n  /* Internal visible state */\n  @State() isVisible: boolean;\n\n  @Watch('open')\n  handleOpenChange() {\n    this.open ? this.show() : this.hide();\n  }\n\n  handleOutsideClick(evt) {\n    const path = evt.composedPath();\n    if (\n      !path.some(item => {\n        return item === this.el;\n      })\n    ) {\n      this.open = false;\n    }\n  }\n\n  startPositioner() {\n    this.stopPositioner();\n    this.updatePositioner();\n    this.positionerCleanup = autoUpdate(this.trigger, this.positioner, this.updatePositioner.bind(this));\n  }\n\n  updatePositioner() {\n    if (!this.open || !this.trigger || !this.positioner) {\n      return;\n    }\n\n    computePosition(this.trigger, this.positioner, {\n      placement: this.placement,\n      middleware: [\n        offset({ mainAxis: this.distance, crossAxis: this.skidding }),\n        flip(),\n        shift(),\n        size({\n          apply: ({ availableWidth: width, availableHeight: height }) => {\n            // Ensure the panel stays within the viewport when we have lots of menu items\n            Object.assign(this.panel.style, {\n              maxWidth: `${width}px`,\n              maxHeight: `${height}px`,\n            });\n          },\n          padding: 8,\n        }),\n      ],\n      strategy: this.hoist ? 'fixed' : 'absolute',\n    }).then(({ x, y, placement }) => {\n      this.positioner.setAttribute('data-placement', placement);\n\n      Object.assign(this.positioner.style, {\n        position: this.hoist ? 'fixed' : 'absolute',\n        left: `${x}px`,\n        top: `${y}px`,\n        right: 'auto',\n      });\n    });\n  }\n\n  stopPositioner() {\n    if (this.positionerCleanup) {\n      this.positionerCleanup();\n      this.positionerCleanup = undefined;\n      this.positioner.removeAttribute('data-placement');\n    }\n  }\n\n  show() {\n    this.scShow.emit();\n    // Prevent subsequent calls to the method, whether manually or triggered by the `open` watcher\n    if (this.isVisible) {\n      return;\n    }\n    this.isVisible = true;\n    this.open = true;\n    this.startPositioner();\n    this.panel.focus();\n  }\n\n  hide() {\n    this.scHide.emit();\n    // Prevent subsequent calls to the method, whether manually or triggered by the `open` watcher\n    if (!this.isVisible) {\n      return;\n    }\n    this.stopPositioner();\n    this.isVisible = false;\n    this.open = false;\n  }\n\n  handleClick(e) {\n    if (this.closeOnSelect) {\n      const path = e.composedPath();\n      if (\n        path.some(item => {\n          return item.classList && item.classList.contains('menu-item');\n        })\n      ) {\n        this.open = false;\n      }\n    }\n  }\n\n  componentWillLoad() {\n    document.addEventListener('mousedown', evt => this.handleOutsideClick(evt));\n  }\n\n  /* Get the slotted menu */\n  getMenu() {\n    let slotted = this.el.shadowRoot.querySelector('slot') as HTMLSlotElement;\n    return slotted.assignedNodes().find(node => {\n      return node.nodeName === 'sc-menu';\n    }) as unknown as ScMenu;\n  }\n\n  render() {\n    return (\n      <div\n        part=\"base\"\n        class={{\n          'dropdown': true,\n          'dropdown--open': this.open,\n          'dropdown--disabled': this.disabled,\n        }}\n      >\n        <span\n          part=\"trigger\"\n          class=\"dropdown__trigger\"\n          ref={el => (this.trigger = el as HTMLElement)}\n          onClick={() => {\n            if (this.disabled) return;\n            if (this.open) {\n              this.hide();\n            } else {\n              setTimeout(() => {\n                this.show();\n              }, 0);\n            }\n          }}\n          aria-expanded=\"true\"\n          aria-haspopup=\"true\"\n        >\n          <slot name=\"trigger\"></slot>\n        </span>\n\n        {/* Position the panel with a wrapper since the popover makes use of translate. This let's us add animations\n        on the panel without interfering with the position. */}\n        <div class=\"dropdown__positioner\" ref={el => (this.positioner = el as HTMLDivElement)}>\n          <div\n            part=\"panel\"\n            class={{\n              'dropdown__panel': true,\n              'position--top-left': this.position === 'top-left',\n              'position--top-right': this.position === 'top-right',\n              'position--bottom-left': this.position === 'bottom-left',\n              'position--bottom-right': this.position === 'bottom-right',\n            }}\n            role=\"menu\"\n            aria-orientation=\"vertical\"\n            aria-labelledby=\"menu-button\"\n            tabindex=\"-1\"\n            onClick={e => this.handleClick(e)}\n            ref={el => (this.panel = el as HTMLElement)}\n          >\n            <slot></slot>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]}