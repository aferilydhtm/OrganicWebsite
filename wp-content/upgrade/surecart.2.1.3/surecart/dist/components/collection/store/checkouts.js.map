{"version":3,"file":"checkouts.js","sourceRoot":"","sources":["../../src/store/checkouts.ts"],"names":[],"mappings":";AACA,OAAO,EAAE,gBAAgB,EAAE,MAAM,SAAS,CAAC;AAC3C,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAC7C,OAAO,EAAE,KAAK,IAAI,aAAa,EAAE,MAAM,iBAAiB,CAAC;AACzD,OAAO,EAAE,YAAY,EAAE,eAAe,EAAE,MAAM,gBAAgB,CAAC;AAE/D,MAAM,KAAK,GAAG,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,0CAAE,mBAAmB;EAC/C,CAAC,CAAC,WAAW,CAA2B;IACpC,IAAI,EAAE,EAAE;IACR,IAAI,EAAE,EAAE;GACT,CAAC;EACJ,CAAC,CAAC,gBAAgB,CACd,wBAAwB,EACxB;IACE,IAAI,EAAE,EAAE;IACR,IAAI,EAAE,EAAE;GACT,EACD,IAAI,CACL,CAAC;AAEN,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;AACvB,eAAe,KAAK,CAAC;AAErB,wBAAwB;AACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAC,MAAuB,EAAE,IAAqB,EAAE,EAAE,WAAC,OAAA,CAAA,MAAA,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,0CAAG,MAAM,CAAC,KAAI,EAAE,CAAA,EAAA,CAAC;AAC9G,MAAM,CAAC,MAAM,WAAW,GAAG,QAAQ,CAAC;AAEpC,wBAAwB;AACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAC,IAAc,EAAE,MAAuB,EAAE,EAAE;;EAClE,MAAM,IAAI,GAAG,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,SAAS,EAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;EAC/C,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;EAC1D,qCAAqC;EACrC,IAAI,aAAa,CAAC,MAAM,KAAK,MAAM,IAAI,aAAa,CAAC,IAAI,KAAK,IAAI,EAAE;IAClE,aAAa,CAAC,QAAQ,GAAG,IAAI,CAAC;GAC/B;EACD,qDAAqD;EACrD,IAAI,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,0CAAE,mBAAmB,MAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,EAAE,CAAA,EAAE;IACnD,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,EAAE,EAAE,CAAC,CAAC,CAAC;GAChH;AACH,CAAC,CAAC;AACF,MAAM,CAAC,MAAM,WAAW,GAAG,QAAQ,CAAC;AAEpC,sCAAsC;AACtC,MAAM,CAAC,MAAM,UAAU,GAAG,CAAC,MAAuB,EAAE,IAAqB,EAAE,EAAE;EAC3E,MAAM,EAAE,CAAC,MAAM,CAAC,EAAE,MAAM,EAAE,GAAG,SAAS,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;EAC7D,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,iBAAiB,EAAE,QAAQ,EAAE,YAAY,EAAE,qBAAqB,EAAE,aAAa,CAAC,CAAC,CAAC;EACxK,OAAO,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACpC,CAAC,CAAC;AACF,MAAM,CAAC,MAAM,aAAa,GAAG,UAAU,CAAC","sourcesContent":["import { Checkout } from '../types';\nimport { createLocalStore } from './local';\nimport { createStore } from '@stencil/store';\nimport { state as checkoutState } from '@store/checkout';\nimport { addQueryArgs, removeQueryArgs } from '@wordpress/url';\n\nconst store = window?.scData?.do_not_persist_cart\n  ? createStore<{ live: any; test: any }>({\n      live: {},\n      test: {},\n    })\n  : createLocalStore<{ live: any; test: any }>(\n      'surecart-local-storage',\n      {\n        live: {},\n        test: {},\n      },\n      true,\n    );\n\nwindow.scStore = store;\nexport default store;\n\n/** Get the checkout. */\nexport const getOrder = (formId: number | string, mode: 'live' | 'test') => store.state[mode]?.[formId] || {};\nexport const getCheckout = getOrder;\n\n/** Set the checkout. */\nexport const setOrder = (data: Checkout, formId: number | string) => {\n  const mode = data?.live_mode ? 'live' : 'test';\n  store.set(mode, { ...store.state[mode], [formId]: data });\n  // update the current checkout state.\n  if (checkoutState.formId === formId && checkoutState.mode === mode) {\n    checkoutState.checkout = data;\n  }\n  // set in url only if we are not persisting the cart.\n  if (window?.scData?.do_not_persist_cart && data?.id) {\n    window.history.replaceState({}, document.title, addQueryArgs(window.location.href, { checkout_id: data?.id }));\n  }\n};\nexport const setCheckout = setOrder;\n\n/** Clear the order from the store. */\nexport const clearOrder = (formId: number | string, mode: 'live' | 'test') => {\n  const { [formId]: remove, ...checkouts } = store.state[mode];\n  window.history.replaceState({}, document.title, removeQueryArgs(window.location.href, 'redirect_status', 'coupon', 'line_items', 'confirm_checkout_id', 'checkout_id'));\n  return store.set(mode, checkouts);\n};\nexport const clearCheckout = clearOrder;\n"]}