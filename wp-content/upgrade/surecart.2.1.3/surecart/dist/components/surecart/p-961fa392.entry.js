import{r as i,h as t,F as s}from"./p-25a9e68f.js";import{a as e}from"./p-d8453138.js";import{i as n}from"./p-2907581f.js";import{a as l}from"./p-1c2e2695.js";import"./p-a586043b.js";const o=":host{display:block}.subscription-details{display:grid;gap:0.25em;color:var(--sc-input-label-color)}";const r=class{constructor(t){i(this,t);this.subscription=undefined;this.pendingPrice=undefined;this.hideRenewalText=undefined;this.activationsModal=undefined;this.loading=undefined;this.hasPendingUpdate=undefined}renderName(){var i,t,s,e,n;if(typeof((t=(i=this.subscription)===null||i===void 0?void 0:i.price)===null||t===void 0?void 0:t.product)!=="string"){return(n=(e=(s=this.subscription)===null||s===void 0?void 0:s.price)===null||e===void 0?void 0:e.product)===null||n===void 0?void 0:n.name}return wp.i18n.__("Subscription","surecart")}async handleSubscriptionChange(){var i,t,s,e;this.hasPendingUpdate=!!((t=Object.keys(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.pending_update)||{}))===null||t===void 0?void 0:t.length);if(((e=(s=this===null||this===void 0?void 0:this.subscription)===null||s===void 0?void 0:s.pending_update)===null||e===void 0?void 0:e.price)&&!(this===null||this===void 0?void 0:this.pendingPrice)&&!this.hideRenewalText){this.pendingPrice=await this.fetchPrice(this.subscription.pending_update.price)}}componentWillLoad(){this.handleSubscriptionChange()}async fetchPrice(i){try{this.loading=true;const t=await e({path:l(`surecart/v1/prices/${i}`,{expand:["product"]})});return t}catch(i){console.error(i)}finally{this.loading=false}}renderRenewalText(){var i,s,e,l,o,r,d,a,u,c,v,h,p,m,f,y,g,w,b;const x=t("sc-subscription-status-badge",{subscription:this===null||this===void 0?void 0:this.subscription});if(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&((s=this===null||this===void 0?void 0:this.subscription)===null||s===void 0?void 0:s.current_period_end_at)){return t("span",null,x," ",wp.i18n.sprintf(wp.i18n.__("Your plan will be canceled on","surecart"))," ",t("sc-format-date",{date:this.subscription.current_period_end_at*1e3,month:"long",day:"numeric",year:"numeric"}))}if(this.hasPendingUpdate){if(!this.pendingPrice&&!((l=(e=this.subscription)===null||e===void 0?void 0:e.pending_update)===null||l===void 0?void 0:l.ad_hoc_amount)){return t("sc-skeleton",null)}if((r=(o=this.subscription)===null||o===void 0?void 0:o.pending_update)===null||r===void 0?void 0:r.ad_hoc_amount){return t("span",null,wp.i18n.__("Your plan switches to","surecart")," ",t("strong",null,t("sc-format-number",{type:"currency",currency:((d=this.pendingPrice)===null||d===void 0?void 0:d.currency)||((u=(a=this.subscription)===null||a===void 0?void 0:a.price)===null||u===void 0?void 0:u.currency),value:(v=(c=this.subscription)===null||c===void 0?void 0:c.pending_update)===null||v===void 0?void 0:v.ad_hoc_amount})," ",n(this.pendingPrice||((h=this.subscription)===null||h===void 0?void 0:h.price)))," ",wp.i18n.__("on","surecart")," ",t("sc-format-date",{date:this.subscription.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}return t("span",null,wp.i18n.__("Your plan switches to","surecart")," ",t("strong",null,this.pendingPrice.product.name)," ",wp.i18n.__("on","surecart")," ",t("sc-format-date",{date:this.subscription.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}if(((p=this===null||this===void 0?void 0:this.subscription)===null||p===void 0?void 0:p.status)==="trialing"&&((m=this===null||this===void 0?void 0:this.subscription)===null||m===void 0?void 0:m.trial_end_at)){return t("span",null,x," ",wp.i18n.sprintf(wp.i18n.__("Your plan begins on","surecart"))," ",t("sc-format-date",{date:(f=this===null||this===void 0?void 0:this.subscription)===null||f===void 0?void 0:f.trial_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}if(((y=this.subscription)===null||y===void 0?void 0:y.status)==="active"&&((g=this.subscription)===null||g===void 0?void 0:g.current_period_end_at)){return t("span",null,x," ",((w=this.subscription)===null||w===void 0?void 0:w.remaining_period_count)===null?wp.i18n.__("Your plan renews on","surecart"):wp.i18n.__("Your next payment is on","surecart")," ",t("sc-format-date",{date:(b=this===null||this===void 0?void 0:this.subscription)===null||b===void 0?void 0:b.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}return x}getActivations(){var i,t,s,e;return(((e=(s=(t=(i=this.subscription)===null||i===void 0?void 0:i.purchase)===null||t===void 0?void 0:t.license)===null||s===void 0?void 0:s.activations)===null||e===void 0?void 0:e.data)||[]).filter((i=>i===null||i===void 0?void 0:i.counted))}renderActivations(){var i;const s=this.getActivations();if(!(s===null||s===void 0?void 0:s.length))return null;return t("sc-flex",{justifyContent:"flex-start",alignItems:"center"},t("sc-tag",{size:"small"},(i=s===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.name),(s===null||s===void 0?void 0:s.length)>1&&t("sc-text",{style:{"--font-size":"var(--sc-font-size-small)",cursor:"pointer"},onClick:i=>{i.preventDefault();i.stopImmediatePropagation();this.activationsModal=true}},"+ ",(s===null||s===void 0?void 0:s.length)-1," More"))}render(){return t("div",{class:"subscription-details"},this.hasPendingUpdate&&t("div",null,t("sc-tag",{size:"small",type:"warning"},wp.i18n.__("Update Scheduled","surecart"))),t("sc-flex",{alignItems:"center",justifyContent:"flex-start"},t("sc-text",{style:{"--font-weight":"var(--sc-font-weight-bold)"}},this.renderName()),this.renderActivations()),!this.hideRenewalText&&t("div",null,this.renderRenewalText()," "),t("slot",null),t("sc-dialog",{label:wp.i18n.__("Activations","surecart"),onScRequestClose:()=>this.activationsModal=false,open:!!this.activationsModal},t("sc-card",{"no-padding":true,style:{"--overflow":"hidden"}},t("sc-stacked-list",null,(this.getActivations()||[]).map((i=>t("sc-stacked-list-row",{style:{"--columns":"2"},mobileSize:0},t("sc-text",{style:{"--line-height":"var(--sc-line-height-dense)"}},t("strong",null,i===null||i===void 0?void 0:i.name),t("div",null,t("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},i===null||i===void 0?void 0:i.fingerprint))),t("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},t("sc-format-date",{type:"timestamp",month:"short",day:"numeric",year:"numeric",date:i===null||i===void 0?void 0:i.created_at})))))))))}static get watchers(){return{subscription:["handleSubscriptionChange"]}}};r.style=o;const d=":host{display:inline-block}";const a=class{constructor(t){i(this,t);this.status=undefined;this.subscription=undefined;this.size="medium";this.pill=false;this.clearable=false}getType(){var i,t,s;if((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end){return"info"}switch(this.status||((t=this.subscription)===null||t===void 0?void 0:t.status)){case"incomplete":return"warning";case"trialing":return"info";case"active":return"success";case"completed":return"success";case"past_due":return"warning";case"canceled":if((s=this.subscription)===null||s===void 0?void 0:s.restore_at){return"info"}return"danger";case"unpaid":return"warning"}}getText(){var i,e,n,l,o;if(((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&this.subscription.current_period_end_at&&((e=this.subscription)===null||e===void 0?void 0:e.status)!=="canceled"){return t(s,null,!!((n=this.subscription)===null||n===void 0?void 0:n.restore_at)?wp.i18n.__("Pauses","surecart"):wp.i18n.__("Cancels","surecart")," ",t("sc-format-date",{type:"timestamp",date:this.subscription.current_period_end_at,month:"short",day:"numeric"}))}switch(this.status||((l=this.subscription)===null||l===void 0?void 0:l.status)){case"incomplete":return wp.i18n.__("Incomplete","surecart");case"trialing":return wp.i18n.__("Trialing","surecart");case"active":return wp.i18n.__("Active","surecart");case"past_due":return wp.i18n.__("Past Due","surecart");case"canceled":if((o=this.subscription)===null||o===void 0?void 0:o.restore_at){return"Paused"}return wp.i18n.__("Canceled","surecart");case"completed":return wp.i18n.__("Completed","surecart");case"unpaid":return wp.i18n.__("Unpaid","surecart")}}render(){return t("sc-tag",{type:this.getType()},this.getText())}};a.style=d;export{r as sc_subscription_details,a as sc_subscription_status_badge};
//# sourceMappingURL=p-961fa392.entry.js.map