{"version":3,"names":["scCartButtonCss","ScCartButton","order","getCheckout","this","formId","mode","getItemsCount","items","_b","_a","line_items","data","count","forEach","item","quantity","componentDidLoad","link","el","closest","addEventListener","e","preventDefault","stopImmediatePropagation","uiStore","state","cart","open","handleParentLinkDisplay","store","onChange","style","display","cartMenuAlwaysShown","render","h","class","part","showEmptyCount"],"sources":["./src/components/ui/sc-cart-button/sc-cart-button.scss?tag=sc-cart-button&encapsulation=shadow","./src/components/ui/sc-cart-button/sc-cart-button.tsx"],"sourcesContent":[":host {\n  display: inline-block;\n  vertical-align: middle;\n  line-height: 1;\n}\n\n::slotted(*) {\n  display: block !important;\n  line-height: 1;\n}\n\n.cart {\n  &__button {\n    padding: 0 4px;\n    height: 100%;\n    display: grid;\n    align-items: center;\n  }\n\n  &__content {\n    position: relative;\n  }\n\n  &__count {\n    box-sizing: border-box;\n    position: absolute;\n    inset: -12px -16px auto auto;\n    text-align: center;\n    font-size: 10px;\n    font-weight: bold;\n    border-radius: var(--sc-cart-icon-counter-border-radius, 9999px);\n    color: var(--sc-cart-icon-counter-color, var(--sc-color-primary-text, var(--sc-color-white)));\n    background: var(--sc-cart-icon-counter-background, var(--sc-color-primary-500));\n    box-shadow: var(--sc-cart-icon-box-shadow, var(--sc-shadow-x-large));\n    padding: 2px 6px;\n    line-height: 14px;\n    min-width: 14px;\n    z-index: 1;\n  }\n\n  &__icon {\n    font-size: var(--sc-cart-icon-size, 1.1em);\n    cursor: pointer;\n\n    sc-icon {\n      display: block;\n    }\n  }\n}\n","import { Component, Element, h, Prop, State } from '@stencil/core';\nimport uiStore from '@store/ui';\nimport store, { getCheckout } from '@store/checkouts';\n\n/**\n * @part base - The elements base wrapper.\n * @part count - The icon base wrapper.\n */\n@Component({\n  tag: 'sc-cart-button',\n  styleUrl: 'sc-cart-button.scss',\n  shadow: true,\n})\nexport class ScCartButton {\n  private link: HTMLAnchorElement;\n  /** The cart element. */\n  @Element() el: HTMLScCartButtonElement;\n\n  /** Is this open or closed? */\n  @State() open: boolean = null;\n\n  /** The order count */\n  @State() count: number = 0;\n\n  /** The form id to use for the cart. */\n  @Prop({ reflect: true }) formId: string;\n\n  /** Are we in test or live mode. */\n  @Prop() mode: 'test' | 'live' = 'live';\n\n  /** Whether the cart icon is always shown when the cart is empty */\n  @Prop() cartMenuAlwaysShown: boolean = true;\n\n  /** Whether the cart count will be shown or not when the cart is empty */\n  @Prop() showEmptyCount: boolean = false;\n\n  order() {\n    return getCheckout(this.formId, this.mode);\n  }\n\n  /** Count the number of items in the cart. */\n  getItemsCount() {\n    const items = this.order()?.line_items?.data;\n    let count = 0;\n    (items || []).forEach(item => {\n      count = count + item?.quantity;\n    });\n    return count;\n  }\n\n  componentDidLoad() {\n    this.link = this.el.closest('a');\n    // this is to keep the structure that WordPress expects for theme styling.\n    this.link.addEventListener('click', e => {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n      uiStore.state.cart = { ...uiStore.state.cart, open: !uiStore.state.cart.open };\n      return false;\n    });\n\n    // maybe hide the parent <a> if there are no items in the cart.\n    this.handleParentLinkDisplay();\n    store.onChange(this.mode, () => this.handleParentLinkDisplay());\n  }\n\n  handleParentLinkDisplay() {\n    this.link.style.display = !this.cartMenuAlwaysShown && !this.getItemsCount() ? 'none' : null;\n  }\n\n  render() {\n    return (\n      <div class=\"cart__button\" part=\"base\">\n        <div class=\"cart__content\">\n          {(this.showEmptyCount || !!this.getItemsCount()) && (\n            <span class=\"cart__count\" part=\"count\">\n              {this.getItemsCount()}\n            </span>\n          )}\n          <div class=\"cart__icon\">\n            <slot />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"4KAAA,MAAMA,EAAkB,mzB,MCaXC,EAAY,M,mCAME,K,WAGA,E,gCAMO,O,yBAGO,K,oBAGL,K,CAElCC,QACE,OAAOC,EAAYC,KAAKC,OAAQD,KAAKE,K,CAIvCC,gB,QACE,MAAMC,GAAQC,GAAAC,EAAAN,KAAKF,WAAO,MAAAQ,SAAA,SAAAA,EAAEC,cAAU,MAAAF,SAAA,SAAAA,EAAEG,KACxC,IAAIC,EAAQ,GACXL,GAAS,IAAIM,SAAQC,IACpBF,EAAQA,GAAQE,IAAI,MAAJA,SAAI,SAAJA,EAAMC,SAAQ,IAEhC,OAAOH,C,CAGTI,mBACEb,KAAKc,KAAOd,KAAKe,GAAGC,QAAQ,KAE5BhB,KAAKc,KAAKG,iBAAiB,SAASC,IAClCA,EAAEC,iBACFD,EAAEE,2BACFC,EAAQC,MAAMC,KAAO,IAAKF,EAAQC,MAAMC,KAAMC,MAAOH,EAAQC,MAAMC,KAAKC,MACxE,OAAO,KAAK,IAIdxB,KAAKyB,0BACLC,EAAMC,SAAS3B,KAAKE,MAAM,IAAMF,KAAKyB,2B,CAGvCA,0BACEzB,KAAKc,KAAKc,MAAMC,SAAW7B,KAAK8B,sBAAwB9B,KAAKG,gBAAkB,OAAS,I,CAG1F4B,SACE,OACEC,EAAA,OAAKC,MAAM,eAAeC,KAAK,QAC7BF,EAAA,OAAKC,MAAM,kBACPjC,KAAKmC,kBAAoBnC,KAAKG,kBAC9B6B,EAAA,QAAMC,MAAM,cAAcC,KAAK,SAC5BlC,KAAKG,iBAGV6B,EAAA,OAAKC,MAAM,cACTD,EAAA,e"}