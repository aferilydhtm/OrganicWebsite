import{r as t,h as i,F as s}from"./p-25a9e68f.js";import{a as e}from"./p-d8453138.js";import{U as r}from"./p-8dcbcebb.js";import{b as o,e as a}from"./p-62338837.js";import{g as d,s as n,a as l}from"./p-b6ef0098.js";import{s as h}from"./p-ffdee0af.js";import{a as c}from"./p-1c2e2695.js";import"./p-61ab3f3a.js";import"./p-4c5e6c8d.js";import"./p-db7ede86.js";import"./p-7c27060f.js";import"./p-6c2a2148.js";import"./p-4d73f82a.js";const p=":host{--sc-drawer-header-spacing:var(--sc-spacing-large);--sc-drawer-body-spacing:var(--sc-spacing-large);--sc-drawer-footer-spacing:var(--sc-spacing-large)}.cart{font-size:16px}.cart__header{display:flex;align-items:center;justify-content:space-between;width:100%;font-size:1em}.cart__close{opacity:0.75;transition:opacity 0.25s ease;cursor:pointer}.cart__close:hover{opacity:1}::slotted(*){padding:var(--sc-drawer-header-spacing);background:var(--sc-panel-background-color);position:relative}::slotted(sc-line-items){flex:1 1 auto;overflow:auto;-webkit-overflow-scrolling:touch;min-height:200px}::slotted(:last-child){border-bottom:0 !important}sc-drawer::part(body){display:flex;flex-direction:column;box-sizing:border-box;padding:0;overflow:hidden}";const u=class{constructor(i){t(this,i);this.open=null;this.formId=undefined;this.header=undefined;this.checkoutLink=undefined;this.cartTemplate=undefined;this.mode="live";this.checkoutUrl=undefined;this.alwaysShow=undefined;this.floatingIconEnabled=true;this.uiState="idle";this.error=undefined}handleOpenChange(){h.set("cart",{...h.state.cart,...{open:this.open}});if(this.open===true){this.fetchOrder()}}order(){return d(this.formId,this.mode)}setOrder(t){n(t,this.formId)}pageHasForm(){return!!document.querySelector("sc-checkout")}getItemsCount(){var t,i;const s=(i=(t=this.order())===null||t===void 0?void 0:t.line_items)===null||i===void 0?void 0:i.data;let e=0;(s||[]).forEach((t=>{e=e+(t===null||t===void 0?void 0:t.quantity)}));return e}handleSetState(t){this.uiState=t.detail}handleErrorEvent(t){this.error=t.detail;this.uiState="idle"}handleCloseCart(){this.open=false}async fetchOrder(){var t;try{this.uiState="loading";const i=await e({method:"GET",path:c(`${o}${(t=this.order())===null||t===void 0?void 0:t.id}`,{expand:a})});this.setOrder(i)}catch(t){console.error(t);throw t}finally{this.uiState="idle"}}componentWillLoad(){r.create(this,this.state());this.open=!!h.state.cart.open;h.onChange("cart",(t=>{this.open=t.open}));l.mode=this.mode}state(){var t,i,s,e,r,o,a,d,n,l,h,c;return{processor_data:(t=this.order())===null||t===void 0?void 0:t.processor_data,uiState:this.uiState,checkoutLink:this.checkoutLink,loading:this.uiState==="loading",busy:this.uiState==="busy",navigating:this.uiState==="navigating",empty:!((e=(s=(i=this.order())===null||i===void 0?void 0:i.line_items)===null||s===void 0?void 0:s.pagination)===null||e===void 0?void 0:e.count),error:this.error,order:this.order(),lineItems:((o=(r=this.order())===null||r===void 0?void 0:r.line_items)===null||o===void 0?void 0:o.data)||[],tax_status:(a=this.order())===null||a===void 0?void 0:a.tax_status,customerShippingAddress:typeof((d=this.order())===null||d===void 0?void 0:d.customer)!=="string"?(l=(n=this.order())===null||n===void 0?void 0:n.customer)===null||l===void 0?void 0:l.shipping_address:{},shippingAddress:(h=this.order())===null||h===void 0?void 0:h.shipping_address,taxStatus:(c=this.order())===null||c===void 0?void 0:c.tax_status,formId:this.formId}}render(){return i(s,null,this.order()&&i(r.Provider,{state:this.state()},i("sc-cart-session-provider",{order:this.order(),"form-id":this.formId,"group-id":this.formId,onScUpdateOrderState:t=>this.setOrder(t.detail),onScError:t=>this.error=t.detail},i("sc-drawer",{open:this.open,onScAfterHide:()=>this.open=false,onScAfterShow:()=>this.open=true},this.open===true&&i(s,null,i("div",{class:"cart__header-suffix",slot:"header"},i("slot",{name:"cart-header"}),i("sc-error",{style:{"--sc-alert-border-radius":"0"},slot:"header",error:this.error,onScUpdateError:t=>this.error=t.detail})),i("slot",null)),this.uiState==="busy"&&i("sc-block-ui",{"z-index":9})))))}static get watchers(){return{open:["handleOpenChange"]}}};u.style=p;export{u as sc_cart};
//# sourceMappingURL=p-ce796c0f.entry.js.map